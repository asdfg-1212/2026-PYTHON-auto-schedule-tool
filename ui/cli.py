# ui/cli.py
"""
å‘½ä»¤è¡Œäº¤äº’ç•Œé¢æ¨¡å—
æä¾›ç”¨æˆ·å‹å¥½çš„é—®ç­”å¼äº¤äº’
"""

from datetime import datetime, timedelta, time
from core.task import Task


def show_welcome():
    """æ˜¾ç¤ºæ¬¢è¿ä¿¡æ¯"""
    print("=" * 50)
    print("     ğŸ“… æ™ºèƒ½æ—¥ç¨‹å®‰æ’å·¥å…·")
    print("=" * 50)
    print()


def first_time_setup():
    """
    é¦–æ¬¡ä½¿ç”¨é…ç½®å‘å¯¼
    è®¾ç½®è¯¾è¡¨å’Œé»˜è®¤ä½œæ¯æ—¶é—´
    
    è¿”å›: Settingså¯¹è±¡
    
    TODO: ä½ éœ€è¦å®ç°ï¼š
    1. æ¬¢è¿ä¿¡æ¯
    2. è¯¢é—®é»˜è®¤ä½œæ¯æ—¶é—´ï¼ˆèµ·åºŠã€ç¡è§‰ã€ä¸‰é¤ï¼‰
    3. è¯¢é—®è¯¾è¡¨ï¼ˆæ¯å‘¨å“ªå‡ å¤©æœ‰è¯¾ï¼Œä»€ä¹ˆæ—¶é—´ï¼‰
    4. ä¿å­˜åˆ°Settings
    5. æ ‡è®°é¦–æ¬¡é…ç½®å®Œæˆ
    
    è¯¾è¡¨è¾“å…¥æç¤ºï¼š
    - è¯¾ç¨‹æ—¶é—´è§„å¾‹ï¼š8:00, 14:00, 18:30 å¼€å§‹
    - æ¯èŠ‚è¯¾ç®—60åˆ†é’Ÿï¼ˆ50åˆ†é’Ÿä¸Šè¯¾+10åˆ†é’Ÿä¼‘æ¯ï¼‰
    """
    print("\n" + "="*60)
    print("  æ¬¢è¿ä½¿ç”¨æ™ºèƒ½æ—¥ç¨‹å®‰æ’å·¥å…·ï¼")
    print("  é¦–æ¬¡ä½¿ç”¨éœ€è¦é…ç½®æ‚¨çš„è¯¾è¡¨å’Œä½œæ¯æ—¶é—´")
    print("="*60)
    
    from config.settings import Settings
    settings = Settings()
    
    # TODO: å®ç°é…ç½®æµç¨‹
    # 1. è¯¢é—®ä½œæ¯æ—¶é—´
    # 2. è¯¢é—®è¯¾è¡¨ï¼ˆå‘¨ä¸€åˆ°å‘¨æ—¥ï¼Œæ¯å¤©çš„è¯¾ç¨‹ï¼‰
    # 3. ä¿å­˜å¹¶æ ‡è®°å®Œæˆ
    
    settings.mark_setup_complete()
    return settings


def load_daily_fixed_slots(date, settings):
    """
    ä»é…ç½®åŠ è½½æŸä¸€å¤©çš„å›ºå®šæ—¶é—´æ®µï¼ˆè¯¾ç¨‹ã€åƒé¥­ï¼‰
    
    å‚æ•°:
        date: datetime.dateå¯¹è±¡
        settings: Settingså¯¹è±¡
    
    è¿”å›:
        å›ºå®šæ—¶é—´æ®µåˆ—è¡¨ [(start_datetime, end_datetime, description), ...]
    
    TODO: ä½ éœ€è¦å®ç°ï¼š
    1. è·å–æ˜ŸæœŸå‡  (date.weekday())
    2. ä»settingsè·å–å½“å¤©çš„è¯¾ç¨‹
    3. ä»settingsè·å–åƒé¥­æ—¶é—´
    4. å°†æ—¶é—´å­—ç¬¦ä¸²è½¬æ¢ä¸ºdatetimeå¯¹è±¡
    5. è¿”å›æ‰€æœ‰å›ºå®šæ—¶é—´æ®µ
    
    æç¤ºï¼š
    - è¯¾ç¨‹æ ¼å¼ï¼š[('08:00', '10:00', 'é«˜ç­‰æ•°å­¦'), ...]
    - éœ€è¦è½¬æ¢ä¸ºï¼š[(datetime(...), datetime(...), 'é«˜ç­‰æ•°å­¦'), ...]
    """
    fixed_slots = []
    
    # TODO: å®ç°åŠ è½½é€»è¾‘
    # weekday = date.weekday()  # 0=å‘¨ä¸€, 6=å‘¨æ—¥
    # courses = settings.get_courses_for_day(weekday)
    # 
    # for start_str, end_str, course_name in courses:
    #     start_time = è§£ææ—¶é—´å­—ç¬¦ä¸²...
    #     end_time = ...
    #     fixed_slots.append((start_time, end_time, course_name))
    
    return fixed_slots


def create_task_from_input():
    """
    é€šè¿‡å‘½ä»¤è¡Œäº¤äº’åˆ›å»ºTaskå¯¹è±¡
    
    è¿”å›: Taskå¯¹è±¡
    
    TODO: ä½ éœ€è¦å®ç°ï¼š
    1. è¯¢é—®ä»»åŠ¡åç§°
    2. è¯¢é—®é¢„è®¡ç”¨æ—¶ï¼ˆåˆ†é’Ÿï¼‰
    3. è¯¢é—®é‡è¦ç¨‹åº¦ï¼ˆ1-5ï¼‰
    4. è¯¢é—®æˆªæ­¢æ—¶é—´ï¼ˆå¯é€‰ï¼‰
    5. è¯¢é—®å¤‡æ³¨ï¼ˆå¯é€‰ï¼‰
    6. åˆ›å»ºå¹¶è¿”å›Taskå¯¹è±¡
    
    æç¤ºï¼š
    - æ·»åŠ è¾“å…¥éªŒè¯ï¼ˆå¦‚ï¼šé‡è¦ç¨‹åº¦å¿…é¡»æ˜¯1-5ï¼‰
    - å¤„ç†ç”¨æˆ·è¾“å…¥é”™è¯¯çš„æƒ…å†µ
    - æˆªæ­¢æ—¶é—´æ ¼å¼ï¼š2026-01-20 18:00
    """
    print("\n--- æ·»åŠ æ–°ä»»åŠ¡ ---")
    
    # TODO: å®ç°äº¤äº’å¼è¾“å…¥
    # name = input("ä»»åŠ¡åç§°: ")
    # while True:
    #     try:
    #         estimated_time = int(input("é¢„è®¡ç”¨æ—¶ï¼ˆåˆ†é’Ÿï¼‰: "))
    #         break
    #     except ValueError:
    #         print("è¯·è¾“å…¥æœ‰æ•ˆçš„æ•°å­—ï¼")
    
    # æš‚æ—¶è¿”å›ç¤ºä¾‹ä»»åŠ¡
    return Task(name="ç¤ºä¾‹ä»»åŠ¡", estimated_time=60, importance=3)


def add_multiple_tasks():
    """
    å¾ªç¯æ·»åŠ å¤šä¸ªä»»åŠ¡
    
    è¿”å›: Taskå¯¹è±¡åˆ—è¡¨
    
    TODO: ä½ éœ€è¦å®ç°ï¼š
    1. å¾ªç¯è°ƒç”¨ create_task_from_input()
    2. è¯¢é—®ç”¨æˆ·æ˜¯å¦ç»§ç»­æ·»åŠ 
    3. è¿”å›ä»»åŠ¡åˆ—è¡¨
    """
    tasks = []
    
    # TODO: å®ç°å¾ªç¯æ·»åŠ é€»è¾‘
    # while True:
    #     task = create_task_from_input()
    #     tasks.append(task)
    #     
    #     continue_add = input("\næ˜¯å¦ç»§ç»­æ·»åŠ ä»»åŠ¡ï¼Ÿ(y/n): ")
    #     if continue_add.lower() != 'y':
    #         break
    
    return tasks


def display_schedule(schedule, date):
    """
    ç¾è§‚åœ°æ˜¾ç¤ºæŸä¸€å¤©çš„æ—¥ç¨‹
    
    å‚æ•°:
        schedule: Scheduleå¯¹è±¡
        date: æ—¥æœŸ
    
    TODO: ä½ éœ€è¦å®ç°ï¼š
    1. æ‰“å°æ—¥æœŸæ ‡é¢˜
    2. éå†schedule.get_schedule()
    3. æ ¼å¼åŒ–è¾“å‡ºæ¯ä¸ªæ—¶é—´æ®µ
    
    ç¤ºä¾‹è¾“å‡ºï¼š
        ========== 2026-01-19 æ—¥ç¨‹å®‰æ’ ==========
        07:00 - 07:30  [å›ºå®š] æ—©é¤
        08:00 - 10:00  [ä»»åŠ¡] å®Œæˆå¤§ä½œä¸š (é‡è¦ç¨‹åº¦: 5)
        ...
    """
    print(f"\n{'='*50}")
    print(f"  {date.strftime('%Y-%m-%d %A')} æ—¥ç¨‹å®‰æ’")
    print(f"{'='*50}")
    
    # TODO: å®ç°æ—¥ç¨‹æ˜¾ç¤ºé€»è¾‘
    pass


def show_menu():
    """
    æ˜¾ç¤ºä¸»èœå•
    
    TODO: ä½ å¯ä»¥è®¾è®¡ä¸»èœå•ï¼ŒåŒ…å«ï¼š
    1. åˆ›å»ºæ–°æ—¥ç¨‹
    2. æŸ¥çœ‹å·²æœ‰æ—¥ç¨‹
    3. ä¿®æ”¹ä»»åŠ¡
    4. é€€å‡ºç¨‹åº
    """
    print("\n--- ä¸»èœå• ---")
    print("1. åˆ›å»ºæ–°æ—¥ç¨‹")
    print("2. æŸ¥çœ‹æ—¥ç¨‹")
    print("3. é€€å‡º")
    # TODO: å®ç°èœå•é€‰æ‹©é€»è¾‘


# æ›´å¤šè¾…åŠ©å‡½æ•°...
# ä½ å¯ä»¥æ ¹æ®éœ€è¦æ·»åŠ æ›´å¤šå‡½æ•°
